# python切片

## 1. 可切片对象的索引方式

Python可切片对象的索引方式包括：**正索引**和**负索引**两部分。

如下图所示，以`a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]`为例：

![img](D:\myNote\markdown\typora\resources\e7887afb3c5d7e7ecc6c1b5fc8c63b99.png)

## 2. 切片操作的一般方式

一个完整的切片表达式包含两个“:”，用于分隔三个参数（start_index、end_index、step），当只有一个“:”时，默认第三个参数step=1

>  切片操作基本表达式：object[start_index : end_index : step]

>  **step**：正负数均可，其**绝对值**大小决定了切取数据时的“**步长**”，而**正负号**决定了“**切取方向**”，正表示“从左往右”取值，负表示“从右往左”取值。当step省略时，默认为1，即从左往右以增量1取值。

>  **start_index**：表示起始索引（包含该索引本身）；该参数省略时，表示从对象“端点”开始取值，至于是从“起点”还是从“终点”开始，则由step参数的正负决定，step为正从“起点”开始，为负从“终点”开始。

>  **end_index**：表示终止索引（**不包含**该索引本身）；该参数省略时，表示一直取到数据”端点“，至于是到”起点“还是到”终点“，同样由step参数的正负决定，step为正时到”终点“，为负时到”起点“。



## 3. 切片操作示例

以下示例均以列表a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9，10]为例：

### 3.1 切取单个值

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
print(f'a[0]:{a[0]}')
print(f'a[0]:{a[-4]}')
```

```
a[0]:0
a[0]:7
```

### 3.2 切取完整对象

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
print(f'a[:]:{a[:]}')
print(f'a[:]:{a[::]}')
```

```
a[:]:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
a[:]:[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
```



### 3.3 start_index和end_index全为正（+）索引的情况

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
print(f'a[1:6]:{a[1:6]}')
print(f'a[1:6:-1]:{a[1:6:-1]}')
print(f'a[6:1]:{a[6:1]}')
print(f'a[6:1:-1]:{a[6:1:-1]}')
print(f'a[:6]:{a[:6]}')
print(f'a[:6:-1]:{a[:6:-1]}')
print(f'a[6:]:{a[6:]}')
print(f'a[6::-1]:{a[6::-1]}')
```

```
a[1:6]:[1, 2, 3, 4, 5]
a[1:6:-1]:[]
a[6:1]:[]
a[6:1:-1]:[6, 5, 4, 3, 2]
a[:6]:[0, 1, 2, 3, 4, 5]
a[:6:-1]:[10, 9, 8, 7]
a[6:]:[6, 7, 8, 9, 10]
a[6::-1]:[6, 5, 4, 3, 2, 1, 0]
```

### 3.4 start_index和end_index全为负（-）索引的情况

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
print(f'a[-1:-6]:{a[-1:-6]}')
print(f'a[-1:-6:-1]:{a[-1:-6:-1]}')
print(f'a[-6:-1]:{a[-6:-1]}')
print(f'a[:-6]:{a[:-6]}')
print(f'a[:-6:-1]:{a[:-6:-1]}')
print(f'a[-6:]:{a[-6:]}')
print(f'a[-6::-1]:{a[-6::-1]}')
```

```
a[-1:-6]:[]
a[-1:-6:-1]:[10, 9, 8, 7, 6]
a[-6:-1]:[5, 6, 7, 8, 9]
a[:-6]:[0, 1, 2, 3, 4]
a[:-6:-1]:[10, 9, 8, 7, 6]
a[-6:]:[5, 6, 7, 8, 9, 10]
a[-6::-1]:[5, 4, 3, 2, 1, 0]
```

### 3.5 start_index和end_index正（+）负（-）混合索引的情况

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
print(f'a[-1:-6]:{a[1:-6]}')
print(f'a[-1:-6:-1]:{a[1:-6:-1]}')
print(f'a[-6:-1]:{a[-1:6]}')
print(f'a[:-6]:{a[-1:6:-1]}')
```

```
a[-1:-6]:[1, 2, 3, 4]
a[-1:-6:-1]:[]
a[-6:-1]:[]
a[:-6]:[10, 9, 8, 7]
```



### 3.6 连续切片操作

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
print(f'a[:8][2:5][-1:]:{a[:8][2:5][-1:]}')
```

```
a[:8][2:5][-1:]:[4]
```

相当于：
`a[:8]=[0, 1, 2, 3, 4, 5, 6, 7]`

`a[:8][2:5]=[2, 3, 4]`

`a[:8][2:5][-1:]=[4]`

理论上可无限次连续切片操作，只要上一次返回的依然是非空可切片对象。

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
print(f'a[:8][2:5][-1:] => {a[:8][2:5][-1:]}')
print(f'a[:8] => {a[:8]}')
print(f'a[:8][2:5] => {a[:8][2:5]}')
print(f'a[:8][2:5][-1:] => {a[:8][2:5][-1:]}')
```

```
a[:8][2:5][-1:] => [4]
a[:8] => [0, 1, 2, 3, 4, 5, 6, 7]
a[:8][2:5] => [2, 3, 4]
a[:8][2:5][-1:] => [4]
```



### 3.7 切片操作的三个参数可以用表达式

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
print(f'a[2+1:3*2:7%3] => {a[2 + 1:3 * 2:7 % 3]}')
```

```
a[2+1:3*2:7%3] => [3, 4, 5]
```



### 3.8 其他对象的切片操作

前面的切片操作说明都以list为例进行说明，但实际上可进行的切片操作的数据类型还有很多，包括元组、字符串等等。

```python
print(f'(0, 1, 2, 3, 4, 5)[:3] => {(0, 1, 2, 3, 4, 5)[:3]}')
s = 'ABCDEFG'[::2]
print(f'\'ABCDEFG\'[::2] => {s}')

for i in range(1, 100)[2::3][-10:]:
    print(i, end=' ')
print()
```

```
(0, 1, 2, 3, 4, 5)[:3] => (0, 1, 2)
'ABCDEFG'[::2] => ACEG
72 75 78 81 84 87 90 93 96 99 
```



## 4. 常用切片操作

以列表：`a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]`为说明对象

### 4.1 取偶数位置

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
b = a[::2]
print(f'b = a[::2] => {b}')
```

### 4.2 取奇数位置

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
b = a[1::2]
print(f'b = a[1::2] => {b}')
```

```
b = a[1::2] => [1, 3, 5, 7, 9]
```

### 4.3 拷贝整个对象

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
b = a[:]
print(f'b = a[:] => {b}')
print(id(a))
print(id(b))

c = a.copy()
print(c)
print(id(a))
print(id(c))
```

```
b = a[:] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2412222198400
2412224933952
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2412222198400
2412224796480
```

需要注意的是：**[:]和.copy()都属于“浅拷贝”，只拷贝最外层元素，内层嵌套元素则通过引用，而不是独立分配内存。**

```python
a = [1, 2, ['A', 'B']]
print(f'a={a}')
b = a[:]
b[0] = 9
b[2][0] = 'D'
print(f'a => {a}')
print(f'b => {b}')
print(f'id(a) => {id(a)}')
print(f'id(b) => {id(b)}')
```

```
a=[1, 2, ['A', 'B']]
a => [1, 2, ['D', 'B']]
b => [9, 2, ['D', 'B']]
id(a) => 2159938662464
id(b) => 2159938524992
```



### 4.4 修改单个元素

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
a[3] = ['A', 'B']
print(f'a => {a}')
```

```
a => [0, 1, 2, ['A', 'B'], 4, 5, 6, 7, 8, 9]
```



### 4.5 在某个位置插入元素

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
a[3:3] = ['A', 'B', 'C']
```

```
[0, 1, 2, 'A', 'B', 'C', 3, 4, 5, 6, 7, 8, 9]
```

### 4.6 替换一部分元素

```python
a = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
a[3:6] = ['A', 'B', 'C']
print(a)
```

```
[0, 1, 2, 'A', 'B', 'C', 6, 7, 8, 9]
```

> a[start : end] = [ list ] 实现插入时，其实就是用 [ list ] 代替 a[start : end] 部分数据，只是要求a[start : end] 为空即可，一般只要 start == end 就可以实现



## 5. 总结

- start_index、end_index、step可同为正、同为负，也可正负混合使用。但必须遵循一个原则，即**两者的取值顺序必须是相同的，否则无法正确切取到数据**：当start_index的位置在end_index的左边时，表示从左往右取值，此时step必须是正数（同样表示从左往右）；当start_index的位置在end_index的右边时，表示从右往左取值，此时step必须是负数（同样表示从右往左）。对于特殊情况，当start_index或end_index省略时，起始索引和终止索引由step的正负来决定，不会存在取值方向出现矛盾的情况，但正和负取到的结果是完全不同的，因为一个向左一个向右。
- 在利用切片时，step的正负是必须要考虑的，尤其是当step省略时。比如a[-1:]，很容易就误认为是从“终点”开始一直取到“起点”，即a[-1:]= [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]，但实际上a[-1:]=a[-1]=9，原因在于step=1表示从左往右取值，而起始索引start_index=-1本身就是对象的最右边的元素了，再往右已经没数据了，因此只有a[-1]一个元素。



