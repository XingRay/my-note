kind: ConfigMap
apiVersion: v1
metadata:
  name: elasticsearch-standalone-config
  namespace: project-test
  annotations:
    kubesphere.io/alias-name: project-test-elasticsearch-standalone-config
    kubesphere.io/creator: dev-zhao
    kubesphere.io/description: 测试项目elasticsearch单节点服务配置
data:
  elasticsearch.yml: >-
    # ======================== Elasticsearch Configuration
    =========================

    #

    # NOTE: Elasticsearch comes with reasonable defaults for most settings.

    #       Before you set out to tweak and tune the configuration, make sure
    you

    #       understand what are you trying to accomplish and the consequences.

    #

    # The primary way of configuring a node is via this file. This template
    lists

    # the most important settings you may want to configure for a production
    cluster.

    #

    # Please consult the documentation for further information on configuration
    options:

    # https://www.elastic.co/guide/en/elasticsearch/reference/index.html

    #

    # ---------------------------------- Cluster
    -----------------------------------

    #

    # Use a descriptive name for your cluster:

    #

    #cluster.name: my-application

    #

    # ------------------------------------ Node
    ------------------------------------

    #

    # Use a descriptive name for the node:

    #

    #node.name: node-1

    #

    # Add custom attributes to the node:

    #

    #node.attr.rack: r1

    #

    # ----------------------------------- Paths
    ------------------------------------

    #

    # Path to directory where to store the data (separate multiple locations by
    comma):

    #

    #path.data: /path/to/data

    #

    # Path to log files:

    #

    #path.logs: /path/to/logs

    #

    # ----------------------------------- Memory
    -----------------------------------

    #

    # Lock the memory on startup:

    #

    #bootstrap.memory_lock: true

    #

    # Make sure that the heap size is set to about half the memory available

    # on the system and that the owner of the process is allowed to use this

    # limit.

    #

    # Elasticsearch performs poorly when the system is swapping the memory.

    #

    # ---------------------------------- Network
    -----------------------------------

    #

    # By default Elasticsearch is only accessible on localhost. Set a different

    # address here to expose this node on the network:

    #

    #network.host: 192.168.0.1

    #

    # By default Elasticsearch listens for HTTP traffic on the first free port
    it

    # finds starting at 9200. Set a specific HTTP port here:

    #

    #http.port: 9200

    #

    # For more information, consult the network module documentation.

    #

    # --------------------------------- Discovery
    ----------------------------------

    #

    # Pass an initial list of hosts to perform discovery when this node is
    started:

    # The default list of hosts is ["127.0.0.1", "[::1]"]

    #

    #discovery.seed_hosts: ["host1", "host2"]

    #

    # Bootstrap the cluster using an initial set of master-eligible nodes:

    #

    #cluster.initial_master_nodes: ["node-1", "node-2"]

    #

    # For more information, consult the discovery and cluster formation module
    documentation.

    #

    # ---------------------------------- Various
    -----------------------------------

    #

    # Allow wildcard deletion of indices:

    #

    #action.destructive_requires_name: false

    cluster.name: "project-test-es-cluster"

    network.host: 0.0.0.0

    xpack.security.enabled: false
  jvm.options: >-
    ################################################################

    ##

    ## JVM configuration

    ##

    ################################################################

    ##

    ## WARNING: DO NOT EDIT THIS FILE. If you want to override the

    ## JVM options in this file, or set any additional options, you

    ## should create one or more files in the jvm.options.d

    ## directory containing your adjustments.

    ##

    ## See
    https://www.elastic.co/guide/en/elasticsearch/reference/8.8/jvm-options.html

    ## for more information.

    ##

    ################################################################




    ################################################################

    ## IMPORTANT: JVM heap size

    ################################################################

    ##

    ## The heap size is automatically configured by Elasticsearch

    ## based on the available memory in your system and the roles

    ## each node is configured to fulfill. If specifying heap is

    ## required, it should be done through a file in jvm.options.d,

    ## which should be named with .options suffix, and the min and

    ## max should be set to the same value. For example, to set the

    ## heap to 4 GB, create a new file in the jvm.options.d

    ## directory containing these lines:

    ##

    ## -Xms4g

    ## -Xmx4g

    ##

    ## See
    https://www.elastic.co/guide/en/elasticsearch/reference/8.8/heap-size.html

    ## for more information

    ##

    ################################################################



    ################################################################

    ## Expert settings

    ################################################################

    ##

    ## All settings below here are considered expert settings. Do

    ## not adjust them unless you understand what you are doing. Do

    ## not edit them in this file; instead, create a new file in the

    ## jvm.options.d directory containing your adjustments.

    ##

    ################################################################


    -XX:+UseG1GC


    ## JVM temporary directory

    -Djava.io.tmpdir=${ES_TMPDIR}


    ## heap dumps


    # generate a heap dump when an allocation from the Java heap fails; heap
    dumps

    # are created in the working directory of the JVM unless an alternative path
    is

    # specified

    -XX:+HeapDumpOnOutOfMemoryError


    # exit right after heap dump on out of memory error

    -XX:+ExitOnOutOfMemoryError


    # specify an alternative path for heap dumps; ensure the directory exists
    and

    # has sufficient space

    -XX:HeapDumpPath=data


    # specify an alternative path for JVM fatal error logs

    -XX:ErrorFile=logs/hs_err_pid%p.log


    ## GC logging

    -Xlog:gc*,gc+age=trace,safepoint:file=logs/gc.log:utctime,level,pid,tags:filecount=32,filesize=64m
